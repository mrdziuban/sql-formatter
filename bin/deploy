#!/usr/bin/env bash

set -e

# if [ "$TRAVIS_BRANCH" != "master" ]; then exit 0 fi

GITHUB_REPO="https://${GITHUB_TOKEN}@github.com/mrdziuban/sql-formatter.git"

commit=$(git rev-parse --short --verify HEAD)

cd dist

git init
git config user.name 'Travis CI'
git config user.email 'mrdziuban+travis@gmail.com'

git remote add upstream "$GITHUB_REPO"
git fetch upstream
git reset upstream/gh-pages

touch .

git add -A .
git commit -m "Generate GitHub pages for commit $commit"
git push -q upstream HEAD:gh-pages
